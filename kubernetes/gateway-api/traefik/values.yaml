deployment:
  kind: DaemonSet  # Run on every schedulable node (worker + control if taint removed)

ports:
  web:
    port: 8000                # Internal container listen port
    hostPort: 80              # Bind directly to host port 80
    protocol: TCP
    expose:
      default: true           # ← Correct object format (fixes error)
  websecure:                  # HTTPS entrypoint
    port: 8443              # Internal container listen port
    hostPort: 443           # Bind directly to host port 443
    protocol: TCP
    expose:
      default: true
    tls:
      enabled: true

service:
  enabled: false              # No Service needed with hostPort

providers:
  kubernetesGateway:
    enabled: true
  kubernetesIngress:
    enabled: false            # Disable legacy Ingress

securityContext:
  capabilities:
    drop: ["ALL"]
    add: ["NET_BIND_SERVICE"] # For binding low ports
  readOnlyRootFilesystem: true
  runAsNonRoot: false         # Required for hostPort 80/443
  runAsUser: 0
  runAsGroup: 0

podSecurityContext:
  fsGroup: 0

logs:
  general:
    level: INFO
  access:
    enabled: true

additionalArguments:
  # Redirect all HTTP → HTTPS permanently
  - "--entrypoints.web.http.redirections.entryPoint.to=websecure"
  - "--entrypoints.web.http.redirections.entryPoint.scheme=https"
  - "--entrypoints.web.http.redirections.entryPoint.permanent=true"
  # Optional: more verbose logs for debugging
  # - "--log.level=DEBUG"
